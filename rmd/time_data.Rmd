---
title: "Longitudinal EDA"
author: "Shuchen Dong, Sitian Zhou, Mengxiao Luan"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: "hide"
---

```{r lib-import, include=FALSE}
library(tidyverse)
library(readxl)
library(dplyr)
library(ggplot2)
library(plotly)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	message = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d

theme_set(
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        text = element_text(family = "Helvetica")) + 
  theme(legend.position = "right"))
```

```{r data}
# import data
billionaire_gdp_indus_usa <- read.csv("../data/billionaire_gdp_indus_usa.csv")
billionaire_gdp <- read.csv("../data/billionaire_gdp.csv")
gdp <- read.csv("../data/gdp.csv")
```

**Global Billionaires' Wealth Trends Analysis**

We conduct some exploratory analysis from two main aspects:

* Billionaire Economic Trends:

  - *GDP Trends:* Analysis of changes in GDPs of countries home to global billionaires, highlighting growth rates and economic development stages.

  - *Sectoral Wealth Growth:* Examination of the wealth growth within industries dominated by billionaires, noting the rise of new economic powerhouses.

  - *City Wealth Analysis:* Tracking the net worth trends in cities with the highest concentration of billionaires, identifying urban patterns of wealth accumulation.


* Billionaire Wealth Distribution  

  - *Global Net Worth Trends:* Observation of the global net worth changes of billionaires, highlighting significant fluctuations due to global economic conditions.

  - *Region Wealth Comparison:* Analysis of the combined net worth of billionaires in the top five countries, reflecting the economic health and wealth generation in these nations.

  - *Gender Wealth Gap:* Examination of the distribution and total net worth of billionaires by gender from 2010 to 2023, underscoring the persistent gender gap in billionaire wealth.
  
  - *Self-Made Billionaires:* Tracking the rise of self-made billionaires over the years, indicating the evolving landscape of entrepreneurial success and self-made wealth.
  
In this analysis, we delve into the intricate dynamics of global economies, industries, and cities from 2010 to 2023, focusing on GDP trends and wealth distribution. Through a series of Longitudinal visualizations, we explore the changes in national GDPs, the evolution of industry wealth, the trends in city net worth, and the distribution of billionaire wealth across different sectors, countries, and genders. Our findings reveal significant shifts in economic growth rates, industry dominance, urban wealth concentration, and the enduring disparities in wealth accumulation, offering a nuanced understanding of the ever-changing landscape of global wealth and economics.


## Billionaire Economic trends
It explores the dynamics of economies, industries, and cities in terms of GDP and wealth concentration.

### GDP Trends
GDP Change from 2010 to 2022 (Countries: USA, CHN, RUS, JPN, DEU):
```{r 5 country gdp}
countries <- c("USA", "CHN", "RUS", "JPN", "DEU")

gdp_selected <- 
  gdp[gdp$code %in% countries & gdp$year >= 2010 & gdp$year <= 2022, ]

# draw GDP plot
gdp_con =
  ggplot(data = gdp_selected, aes(x = year, y = gdp, color = code)) +
  theme_minimal() +
  geom_line(size = 1.2) +
  labs(title = "GDP change from 2010 to 2022", x = "Year", y = "GDP", color = "Region Code") +
  scale_x_continuous(breaks = 2010:2022)+
  theme(plot.title = element_text(hjust = 0.5)) 

ggplotly(gdp_con)

```

Summary: The graph demonstrates the varying economic trajectories of these five countries over a 12-year period, with China showing the most remarkable growth rate, the USA maintaining a strong and steadily increasing GDP, while Japan shows relatively little change, indicating different stages of economic development and growth rates.


### Sectoral Wealth Growth
Number of billionaires in different industries by year (2010 to 2023):
```{r barplot-all industries}
bil_industry = 
  billionaire_gdp |> 
  mutate(industries = replace(industries, industries == "Billionaire", NA))|>
  drop_na(industries) |> 
  group_by(year, industries) |> 
  summarize(n = n()) |> 
  ggplot(aes(x = year, y = n, fill = industries))+
  theme_minimal()+
  geom_bar(position="stack", stat="identity")+
  labs(title = "Industry-level GDP change from 2010 to 2023", 
       x = "Year", y = "GDP", color = "Industries")+
  scale_x_continuous(breaks = 2010:2023)+
  theme(plot.title = element_text(hjust = 0.6)) 

ggplotly(bil_industry)
```


Number of billionaires in different industries by year in the USA (2017 to 2022):
```{r barplot-US industries}
indus_usa = 
  billionaire_gdp_indus_usa |> 
  drop_na(industry_gdp) |> 
  group_by(year, industries) |> 
  summarize(n = n()) |> 
  ggplot(aes(x = year, y = n, fill = industries)) +
  theme_minimal() +
  geom_bar(position="stack", stat="identity") +
  labs(title = "Industry-level GDP change in the USA from 2017 to 2022", 
       x = "Year", y = "GDP", color = "Industries") +
  scale_x_continuous(breaks = 2017:2022)+
  theme(plot.title = element_text(hjust = 0.6)) 

ggplotly(indus_usa)

```


Total industry GDP by year in the USA (2017 to 2022):
```{r US industry gdp overtime}
data_filtered <- billionaire_gdp_indus_usa %>%
  filter(year >= 2017 & year <= 2022) %>% 
  na.omit()


total_gdp_by_year_industry <- data_filtered %>%
  group_by(year, industries) %>%
  summarise(total_gdp_by_year_industry = sum(industry_gdp, na.rm = TRUE))

gdp_industry_plot <- total_gdp_by_year_industry |> 
  ggplot(aes(x = year, y = total_gdp_by_year_industry, color = industries)) +
    geom_line(size = 1.2) +
    theme_minimal() +
    labs(title = "Total industry GDP by year from 2017 to 2022 in USA", 
         x = "Year", y = "Industry GDP", color = "Industries")+
  theme(plot.title = element_text(hjust = 0.5))

ggplotly(gdp_industry_plot)

```
 
Summary: It shows that from 2017 to 2022, the Finance & Investment sectors in the USA experienced the most significant growth. In contrast, the Metals and Mining industry saw the least growth. It has been observed that due to the impact of the COVID-19 pandemic, billionaires in all industries in the USA and around the world faced an overall slump in 2020. Despite such a setback, these indicators generally tend to rise over time, indicating that the GDP of each industry is growing comprehensively.


### City Wealth Analysis
Top 5 Cities' Net Worth Trend by Year (2010 to 2023):
find different city of residence billionaire net worth change over time
```{r net_worth vs cities overtime}
data_filtered <- billionaire_gdp %>%
  filter(
    year >= 2010 & year <= 2023, 
    country_of_citizenship == "United States")%>%
  na.omit()

net_worth_by_city_year <- data_filtered %>%
  group_by(year, city_of_residence) %>%
  summarise(total_net_worth = sum(net_worth, na.rm = TRUE)) %>%
  ungroup()

# top5
top_cities_by_year <- net_worth_by_city_year %>%
  group_by(year) %>%
  slice_max(order_by = total_net_worth, n = 5) %>%
  ungroup()

tnw_residence = 
  ggplot(top_cities_by_year, aes(x = year, y = total_net_worth, , color = city_of_residence)) +
  geom_line(size = 1.2) +
  labs(title = "Top 5 cities' net worth trend by year (2010-2023)",
       x = "Year", y = "Total net worth (billions)",
       color = "City of residence") +
  scale_x_continuous(breaks = 2010:2023)+
  theme(legend.position = "right") +
  theme(plot.title = element_text(hjust = 0.5))

ggplotly(tnw_residence)

```

Note: Here are the top 5, and there are indeed 5 more. This is because in some years, the total city of net worth is surpassed by others.

Summary: The chart shows rising billionaire net worth in five cities from 2010 to 2023, with New York's significant growth standing out. Dallas and Medina also grew notably post-2015, while Austin and Bentonville had modest increases. A slight dip in 2020 suggests the impact of the COVID-19 pandemic. There's a data gap for Bentonville in 2020 and a title discrepancy with ten cities listed instead of five, indicating wealth concentration and potential urban-rural disparities.



## Billionaire Wealth Distribution
This category focuses on the distribution of wealth among different groups, genders, and the rise of self-made billionaires.

### Global Net Worth Trends
A quick overview: trend of total net worth of all billionaires (2010 to 2023)
```{r networth all overtime}
bil_all = 
  billionaire_gdp |> 
  group_by(year) |> 
  summarize(total_net_worth = sum(net_worth)) |> 
  ggplot(aes(x = year, y = total_net_worth, color = "#440154")) +
  geom_line(size = 1.2) +
  labs(title = "Total net worth of billionaire from 2010 to 2023",
       x = "Year", y = "Total net worth (billions)")+
  scale_x_continuous(breaks = 2010:2023)+
  theme(plot.title = element_text(hjust = 0.5),
        legend.position = "none")

ggplotly(bil_all)

```

Summary: The line graph portrays the trajectory of a billionaire's net worth from 2010 to 2023, with a general upward trend punctuated by notable declines in 2016 and 2020, likely due to market downturns and the economic impact of the COVID-19 pandemic, respectively. Following the 2020 dip, there was a dramatic rebound, culminating in a peak in 2021, indicating a robust recovery that might be attributed to a post-pandemic economic boom, strategic business decisions, or a favorable investment climate.


### Region Wealth Comparison
Total Net Worth of Billionaires (2010 to 2023, Top 5 Countries):
```{r networth 5 countries overtime}
data_filtered <- billionaire_gdp %>%
  filter(year >= 2010 & year <= 2023)

# group by country net worth over time 
total_net_worth_by_country <- data_filtered %>%
  group_by(region_code) %>%
  summarise(total_net_worth = sum(net_worth, na.rm = TRUE))

# net worth top 5 countries
top_countries <- total_net_worth_by_country %>%
  top_n(5, total_net_worth) %>%
  pull(region_code)

top_countries_data <- data_filtered %>%
  filter(region_code %in% top_countries)

total_net_worth_by_year_country <- top_countries_data %>%
  group_by(year, region_code) %>%
  summarise(total_net_worth = sum(net_worth, na.rm = TRUE))

# plot
tnw_citizen =
  ggplot(total_net_worth_by_year_country, aes(x = year, y = total_net_worth, color = region_code)) +
  geom_line(size = 1.2) +
  theme_minimal() +
  labs(title = "Total net worth of billionaires by top 5 regions from 2010 to 2023",
       x = "Year", y = "Total net worth (billions)",
       color = "Region code")+
  scale_x_continuous(breaks = 2010:2023)+
  theme(plot.title = element_text(hjust = 0.5))

ggplotly(tnw_citizen)
```

Summary: The graph comparing the net worth of billionaires from 2010 to 2023 in the top five regions shows the USA leading with a significant surge post-2015, indicative of robust economic growth and wealth generation. China's trend suggests rapid wealth creation with some instability. Germany displays steady progress, reflecting a stable economy. India's consistent rise aligns with its economic development, while Hong Kong's initial growth is followed by a decline post-2019, likely due to socio-political and economic challenges in the region. This distribution of billionaire wealth highlights the varying economic dynamics and the impact of regional and global factors on wealth accumulation.

### Gender Wealth Gap
Percentage of Billionaires by Gender (2010-2023):
```{r barplot-gender-scaled}
# scale it to 1 to analyze the proportions
bil_gender_prop <-
  billionaire_gdp|> 
  drop_na(gender) |> 
  group_by(year, gender) |> 
  summarize(n = n()) |> 
  group_by(year) |> 
  mutate(total = sum(n),
         prop = n/ total)

bil_gender = 
  bil_gender_prop |> 
  ggplot(aes(x = year, y = prop, fill = gender))+
  geom_bar(position="stack", stat="identity") +
  labs(title = "Proportion of billionaires by gender from 2010 to 2023",
       x = "Year", y = "Proportion", color = "Gender")+
  scale_x_continuous(breaks = 2010:2023)+
  theme(plot.title = element_text(hjust = 0.5))

ggplotly(bil_gender)
  
```
Comments: The first chart, a bar plot, illustrates the proportion of male and female billionaires from 2010 to 2023, indicating a consistent predominance of males in each year, with females representing a very small fraction of the total. This disparity in representation may reflect long-standing gender imbalances in wealth accumulation and opportunities for economic advancement.

Total Net Worth by Gender (2010 to 2023):
```{r ave_net_worth by gender}

billionaires_filtered <- billionaire_gdp %>%
  filter(year >= 2010 & year <= 2023) %>%  na.omit()

total_net_worth_by_year_gender <- billionaires_filtered %>%
  group_by(year, gender) %>%
  summarise(total_net_worth = sum(net_worth, na.rm = TRUE))


tnw_gender = 
  ggplot(total_net_worth_by_year_gender, aes(x = year, y = total_net_worth, color = gender)) +
  geom_line(size = 1.2) +
  theme_minimal() +
  labs(title = "Total net worth by gender from 2010 to 2023",
       x = "Year", y = "Total net worth (billions)", color = "Gender")+
  scale_x_continuous(breaks = 2010:2023)+
  theme(plot.title = element_text(hjust = 0.5))

ggplotly(tnw_gender)
```
Comments: The second chart, a line graph, shows the total net worth by gender from 2010 to 2023. The net worth of male billionaires is significantly higher than that of females throughout the period, with a particularly steep increase for males after 2015. The consistent gap and the sharp rise in male net worth could be due to a combination of factors, including the compounding effect of existing wealth, gender disparities in key industries, and potentially more males being active in high-growth sectors such as technology and finance.

Summary: Both charts underscore a persistent gender gap in billionaire wealth, suggesting systemic barriers to entry and growth for women in the highest echelons of wealth. The trends could also reflect broader societal and economic structures that historically favor male dominance in business and wealth creation.

### Self-Made Billionaires
Self-Made Status Count Over Years (2010 to 2023):
```{r barplot-self_made-scaled}
# scale it to 1 to analyze the proportions
bil_selfmade_prop <-
  billionaire_gdp|> 
  drop_na(self_made) |> 
  group_by(year, self_made) |> 
  summarize(n = n()) |> 
  group_by(year) |> 
  mutate(total = sum(n),
         prop = n/ total)

bil_selfmade = 
  bil_selfmade_prop |> 
  ggplot(aes(x = year, y = prop, fill = self_made)) +
  geom_bar(position="stack", stat="identity") +
  labs(title = "Proportion of self-made status count from 2010 to 2023",
       x = "Year", y = "Proportion", color = "Self-made")+
  theme(plot.title = element_text(hjust = 0.5))+
  scale_x_continuous(breaks = 2010:2023)

ggplotly(bil_selfmade)
```

Summary: The bar chart depicting the proportion of self-made billionaires from 2010 to 2023 demonstrates a consistent majority of individuals who have amassed their wealth independently, without inheritance or existing family wealth. This consistent trend highlights the persistent entrepreneurial opportunities and the effectiveness of modern economies in fostering self-made success stories, potentially driven by technological innovation, global market access, and the availability of venture capital. It reflects a global environment where skill, innovation, and strategic business practices can lead to significant wealth creation.







